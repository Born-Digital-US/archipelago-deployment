{
  "data": {
    "type": "metadatadisplay_entity--metadatadisplay_entity",
    "id": "ad7aab5a-4bb3-43f2-8328-2b62895a3821",
    "attributes": {
      "name": "IIIF Presentation API 3.0 Manifest",
      "twig": "{# This Template generates IIIF 3.0 DRAFT Presentation API Manifest from a Strawberry Field\r\nJSON.\r\n\r\nStructures passed from Archipelago are\r\n- node\r\n  The full Node entity\r\n- data\r\n  The Full JSON Structure converted in an Array\r\n- iiif_server\r\n  The publicly available IIIF Server (Global Setting)\r\n\r\nSince JSON was decoded into the 'data' values are valid PHP but could not\r\nbe valid JSON when outputting. So We use data.description|json_encode|raw\r\nWithout Double quotes.\r\n\r\n#}\r\n{% set Webserverurl =  url('<front>')|render|replace({':8001\/':''}) ~ ':8183\/iiif\/2\/' %}\r\n  {% set IIIFserverurl = iiif_server ? iiif_server ~ '\/': Webserverurl %}\r\n    {% set currenturl = '<current>' %}\r\n      {% if node.id %}\r\n          {% set nodeurl = url('entity.node.canonical', {'node': node.id}, {'absolute': true}) %}\r\n      {% else %}\r\n          {% set nodeurl = currenturl %}\r\n      {% endif%}\r\n            {% set len = language.getId() ? language.getId() : \"en\" %}\r\n{\r\n\"@context\": [\r\n  \"http:\/\/www.w3.org\/ns\/anno.jsonld\",\r\n  \"http:\/\/iiif.io\/api\/presentation\/3\/context.json\"\r\n],\r\n\"type\": \"Manifest\",\r\n\"id\": \"{{ nodeurl }}\",\r\n\"label\": {\r\n\"{{ len }}\": [\r\n{{ node.label|json_encode|raw }}\r\n]\r\n},\r\n\"description\":  {\r\n\"{{ len }}\": [\r\n{{ data.description|json_encode|raw  }}\r\n]\r\n},\r\n\"requiredStatement\": {\r\n\"label\": { \"en\": [ \"Attribution\" ] },\r\n\"value\": { \"en\": [ \"Provided by Archipelago Deployment\" ] }\r\n},\r\n\"metadata\": [\r\n{% for agent in attribute(data, 'edm_agent') %}\r\n    {\r\n    \"label\": {\r\n    \"{{ len }}\": [\r\n    {{ agent.role_label|json_encode|raw }}\r\n    ]\r\n    },\r\n    \"value\": {\r\n    \"{{ len }}\": [\r\n    {{ agent.name_label|json_encode|raw }}\r\n    ]\r\n    }\r\n    },\r\n{% endfor %}\r\n{\r\n\"label\": {\r\n\"{{ len }}\": [\r\n\"description\"\r\n]\r\n},\r\n\"value\": {\r\n\"{{ len }}\": [\r\n{{ data.description|json_encode|raw }}\r\n]\r\n}\r\n},\r\n{\r\n\"label\": {\r\n\"{{ len }}\": [\r\n\"navDate\"\r\n]\r\n},\r\n\"value\":  {\r\n\"{{ len }}\": [\r\n\"{{ node.getChangedTime|date(\"F jS \\\\a\\\\t g:ia\") }}\"\r\n]\r\n}\r\n},\r\n{\r\n\"label\": {\r\n\"{{ len }}\": [\r\n\"license\"\r\n]\r\n},\r\n\"value\": {\r\n\"{{ len }}\": [\r\n\"http:\/\/rightsstatements.org\/vocab\/InC-EDU\/1.0\/\"\r\n]\r\n}\r\n}\r\n],\r\n{% if attribute(data, 'memberof') %}\r\n    {% set currentnode = 'node\/' ~ data.memberof %}\r\n    \"within\": \"{{ url(currentnode) }}\",\r\n{% else %}\r\n    {% set currentnode = '<current>' %}\r\n{% endif %}\r\n\"items\": [\r\n{% for page in attribute(data, 'as:image') %}\r\n    {\r\n    \"id\": \"{{ nodeurl }}\/iiif\/canvas\/p{{ loop.index }}\",\r\n    \"type\": \"Canvas\",\r\n    \"label\": \"p. {{ loop.index }}\",\r\n    \"width\": 3,\r\n    \"height\": 4,\r\n    \"items\": [{\r\n    \"type\": \"AnnotationPage\",\r\n    \"items\": [{\r\n    \"id\": \"{{ nodeurl }}\/iiif\/annotation\/p{{ loop.index }}\",\r\n    \"type\": \"Annotation\",\r\n    \"motivation\": \"painting\",\r\n    \"target\": \"{{ nodeurl }}\/iiif\/canvas\/p{{ loop.index }}\",\r\n    \"body\": {\r\n    \"id\": \"{{ IIIFserverurl ~ page['url']|replace({'s3:\/\/':''})|replace({'private:\/\/':''})|url_encode }}\/full\/1200,\/0\/default.jpg\",\r\n    \"type\": \"Image\",\r\n    \"format\": \"image\/jpeg\",\r\n    \"width\": 1200,\r\n    \"service\": {\r\n    \"type\": \"ImageService2\",\r\n    \"profile\": \"level2\",\r\n    \"id\": \"{{ IIIFserverurl ~ page['url']|replace({'s3:\/\/':''})|replace({'private:\/\/':''})|url_encode }}\"\r\n    }\r\n    }\r\n    }]\r\n    }]\r\n    }{{ not loop.last ? ',' : '' }}\r\n{% endfor %}\r\n],\r\n\"structures\": [{\r\n\"id\": \"{{ nodeurl }}\/iiif\/range\/r1\",\r\n\"type\": \"Range\",\r\n\"label\": {\r\n\"{{ len }}\": [\r\n{{ node.label|json_encode|raw  }}\r\n]\r\n},\r\n\"items\": [\r\n{% for range in attribute(data, 'as:image') %}\r\n    \"{{ nodeurl }}\/iiif\/canvas\/p{{ loop.index }}\"{{ not loop.last ? ',' : '' }}\r\n{% endfor %}\r\n]\r\n}]\r\n}",
      "langcode": "und",
      "mimetype": "application/ld+json"
    }
  }
}
